<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 18:40:09 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-14/HBASE-14.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-14] [hbase] Hung MR job writing hbase</title>
                <link>https://issues.apache.org/jira/browse/HBASE-14</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Running a simple, fairly large job on the cluster, a few of the reduce steps failed; all that did are effectively hung.  Looking at failures, I see this strange output:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;2007-11-13 02:09:09,606 DEBUG org.apache.hadoop.hbase.HTable: reloading table servers because: java.io.IOException: Region triples,http:&lt;span class=&quot;code-comment&quot;&gt;//purl.org/dc/terms/bibliographicCitation,1194919500610 closed
&lt;/span&gt;	at org.apache.hadoop.hbase.HRegion.startUpdate(HRegion.java:1142)
	at org.apache.hadoop.hbase.HRegionServer.startUpdate(HRegionServer.java:1239)
	at org.apache.hadoop.hbase.HRegionServer.batchUpdate(HRegionServer.java:1113)
	at sun.reflect.GeneratedMethodAccessor3.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:379)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:596)

2007-11-13 02:09:19,778 DEBUG org.apache.hadoop.hbase.HTable: reloading table servers because: org.apache.hadoop.hbase.NotServingRegionException: triples,http:&lt;span class=&quot;code-comment&quot;&gt;//purl.org/dc/terms/bibliographicCitation,1194919500610
&lt;/span&gt;	at org.apache.hadoop.hbase.HRegionServer.getRegion(HRegionServer.java:1325)
	at org.apache.hadoop.hbase.HRegionServer.getRegion(HRegionServer.java:1297)
	at org.apache.hadoop.hbase.HRegionServer.startUpdate(HRegionServer.java:1238)
	at org.apache.hadoop.hbase.HRegionServer.batchUpdate(HRegionServer.java:1113)
	at sun.reflect.GeneratedMethodAccessor3.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:379)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:596)

2007-11-13 02:09:30,039 DEBUG org.apache.hadoop.hbase.HTable: reloading table servers because: org.apache.hadoop.hbase.NotServingRegionException: triples,http:&lt;span class=&quot;code-comment&quot;&gt;//purl.org/dc/terms/bibliographicCitation,1194919500610
&lt;/span&gt;	at org.apache.hadoop.hbase.HRegionServer.getRegion(HRegionServer.java:1325)
	at org.apache.hadoop.hbase.HRegionServer.getRegion(HRegionServer.java:1297)
	at org.apache.hadoop.hbase.HRegionServer.startUpdate(HRegionServer.java:1238)
	at org.apache.hadoop.hbase.HRegionServer.batchUpdate(HRegionServer.java:1113)
	at sun.reflect.GeneratedMethodAccessor3.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:379)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:596)

2007-11-13 02:09:40,275 DEBUG org.apache.hadoop.hbase.HTable: reloading table servers because: org.apache.hadoop.hbase.NotServingRegionException: triples,http:&lt;span class=&quot;code-comment&quot;&gt;//purl.org/dc/terms/bibliographicCitation,1194919500610
&lt;/span&gt;	at org.apache.hadoop.hbase.HRegionServer.getRegion(HRegionServer.java:1325)
	at org.apache.hadoop.hbase.HRegionServer.getRegion(HRegionServer.java:1297)
	at org.apache.hadoop.hbase.HRegionServer.startUpdate(HRegionServer.java:1238)
	at org.apache.hadoop.hbase.HRegionServer.batchUpdate(HRegionServer.java:1113)
	at sun.reflect.GeneratedMethodAccessor3.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:379)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:596)

2007-11-13 02:09:55,379 WARN org.apache.hadoop.mapred.TaskTracker: Error running child
org.apache.hadoop.hbase.NotServingRegionException: org.apache.hadoop.hbase.NotServingRegionException: triples,http:&lt;span class=&quot;code-comment&quot;&gt;//purl.org/dc/terms/bibliographicCitation,1194919500610
&lt;/span&gt;	at org.apache.hadoop.hbase.HRegionServer.getRegion(HRegionServer.java:1325)
	at org.apache.hadoop.hbase.HRegionServer.getRegion(HRegionServer.java:1297)
	at org.apache.hadoop.hbase.HRegionServer.startUpdate(HRegionServer.java:1238)
	at org.apache.hadoop.hbase.HRegionServer.batchUpdate(HRegionServer.java:1113)
	at sun.reflect.GeneratedMethodAccessor3.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:379)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:596)

	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:513)
	at org.apache.hadoop.hbase.RemoteExceptionHandler.decodeRemoteException(RemoteExceptionHandler.java:82)
	at org.apache.hadoop.hbase.HTable.commit(HTable.java:734)
	at org.apache.hadoop.hbase.HTable.commit(HTable.java:706)
	at org.apache.hadoop.hbase.mapred.TableOutputFormat$TableRecordWriter.write(TableOutputFormat.java:89)
	at org.apache.hadoop.hbase.mapred.TableOutputFormat$TableRecordWriter.write(TableOutputFormat.java:63)
	at org.apache.hadoop.mapred.ReduceTask$2.collect(ReduceTask.java:308)
	at TriplesTest$TestReducer.reduce(TriplesTest.java:66)
	at TriplesTest$TestReducer.reduce(TriplesTest.java:51)
	at org.apache.hadoop.mapred.ReduceTask.run(ReduceTask.java:326)
	at org.apache.hadoop.mapred.TaskTracker$Child.main(TaskTracker.java:1935)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Why is the reducer client being pig-headed trying to go against a region that has been closed?  Why not recalibrate?&lt;/p&gt;

&lt;p&gt;Here is master log from around same time on the problem region:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;...
2007-11-13 02:10:17,867 INFO org.apache.hadoop.hbase.HMaster: region triples,http:&lt;span class=&quot;code-comment&quot;&gt;//purl.org/dc/terms/bibliographicCitation,1194919500610 split. New regions are: triples,http://purl.org/dc/terms/bibliographicCitation,1194919707661, triples,http://purl.org/dc/terms/references,1194919707661
&lt;/span&gt;...
2007-11-13 02:11:47,313 DEBUG org.apache.hadoop.hbase.HMaster: HMaster.metaScanner scanner: -3075797136896920808 regioninfo: {regionname: triples,http:&lt;span class=&quot;code-comment&quot;&gt;//purl.org/dc/terms/bibliographicCitation,1194919500610, startKey: &amp;lt;http://purl.org/dc/terms/bibliographicCitation&amp;gt;, offline: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, split: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, tableDesc: {name: triples, families: {triples:={name: triples, max versions: 3, compression: NONE, in memory: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, max length: 2147483647, bloom filter: none}}}}, server: 208.76.44.140:60010, startCode: -647590197693256616
&lt;/span&gt;...
2007-11-13 02:11:47,317 INFO org.apache.hadoop.hbase.HMaster: Deleting region triples,http:&lt;span class=&quot;code-comment&quot;&gt;//purl.org/dc/terms/bibliographicCitation,1194919500610 because daughter splits no longer hold references&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12382477">HBASE-14</key>
            <summary>[hbase] Hung MR job writing hbase</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="5">Cannot Reproduce</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="stack">stack</reporter>
                        <labels>
                    </labels>
                <created>Wed, 14 Nov 2007 01:21:08 +0000</created>
                <updated>Thu, 20 Sep 2012 22:10:37 +0000</updated>
                            <resolved>Thu, 15 May 2008 19:37:45 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12549195" author="vercegovac" created="Thu, 6 Dec 2007 21:17:12 +0000"  >&lt;p&gt;Thanks for the detailed log. Let me know if I&apos;m interpreting this correctly:&lt;/p&gt;

&lt;p&gt;1. The reduce HTable client issues a startUpdate and gets a valid xact id&lt;br/&gt;
from the RegionServer.&lt;/p&gt;

&lt;p&gt;2. The region splits so the updating region is placed off-line.&lt;/p&gt;

&lt;p&gt;3. The reduce HTable client issues a commit but finds the Region is offline&lt;br/&gt;
(and checks for this some number of times). An IOException is thrown&lt;br/&gt;
which kills the reduce task.&lt;/p&gt;

&lt;p&gt;Do you expect the protocol to be in this case, for user code to catch IOExceptions,&lt;br/&gt;
abort, then retry the entire update? Are there certain exceptions that can be thrown &lt;br/&gt;
that should be specialy handled, i.e., it would be futile to re-try?&lt;/p&gt;</comment>
                            <comment id="12553409" author="stack" created="Wed, 19 Dec 2007 17:30:34 +0000"  >&lt;p&gt;It was good to meetup last night Vuk. &lt;/p&gt;

&lt;p&gt;Your understanding above of whats going on is about right except the bit where you say the IOE causes the reduce to fail.  The reduce doesn&apos;t fail.  It just keeps on going but job never seems to complete.  It looks like the reduce keeps trickling in updates, just enough to get in the way of the TaskTracker killing the job.  &lt;/p&gt;

&lt;p&gt;hbase has moved on since I pasted the above logs but last time I tried this job, a few weeks ago, so log output is different now but it still fails to complete; 2 of the 8 reduces finish up fairly promptly but the other 6 hang out for ever seemingly.&lt;/p&gt;

&lt;p&gt;The problematic class is using TIF and TOF (Last night I was confused thinking it was doing its own updating and not using TIF/TOF at all).   The class came from a gentleman who was having other hbase issues.  Let me first get permission to post it and data.&lt;/p&gt;</comment>
                            <comment id="12553423" author="stack" created="Wed, 19 Dec 2007 18:22:39 +0000"  >&lt;p&gt;Holger Stenzhorn gave his blessing.  Here is the class.  If you want the data file, let me know and I&apos;ll arrange it so you can pull it (too big to attach here).&lt;/p&gt;</comment>
                            <comment id="12565501" author="bryanduxbury" created="Mon, 4 Feb 2008 20:12:50 +0000"  >&lt;p&gt;What&apos;s the status of this issue?&lt;/p&gt;</comment>
                            <comment id="12597237" author="stack" created="Thu, 15 May 2008 19:37:45 +0000"  >&lt;p&gt;Resovling as can&apos;t reproduce.  Code is out of date and I&quot;ve mislaid the data.  Will wait till someone else complains about hbase not working as an MR sink.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12371956" name="TriplesTest.java" size="4803" author="stack" created="Wed, 19 Dec 2007 18:22:39 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 6 Dec 2007 21:17:12 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>24852</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 32 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0h3fz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>97820</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>