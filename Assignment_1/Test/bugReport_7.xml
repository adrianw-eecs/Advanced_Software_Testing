<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 18:40:05 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-7/HBASE-7.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-7] [hbase] Provide a HBase checker and repair tool similar to fsck</title>
                <link>https://issues.apache.org/jira/browse/HBASE-7</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;We need a tool to verify (and repair) HBase much like fsck&lt;/p&gt;</description>
                <environment></environment>
        <key id="12384791">HBASE-7</key>
            <summary>[hbase] Provide a HBase checker and repair tool similar to fsck</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png">New Feature</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dhruba">dhruba borthakur</assignee>
                                    <reporter username="jimk">Jim Kellerman</reporter>
                        <labels>
                            <label>gsoc</label>
                    </labels>
                <created>Mon, 17 Dec 2007 17:14:53 +0000</created>
                <updated>Fri, 20 Nov 2015 13:01:44 +0000</updated>
                            <resolved>Tue, 22 Jun 2010 21:43:35 +0000</resolved>
                                                    <fixVersion>0.90.0</fixVersion>
                                    <component>util</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>8</watches>
                                                                                                            <comments>
                            <comment id="12552524" author="stack" created="Mon, 17 Dec 2007 20:44:35 +0000"  >&lt;p&gt;One suggestion: The hbsk tool would list all regions in the filesystem and make sure each has an entry in the .META.&lt;/p&gt;</comment>
                            <comment id="12552525" author="stack" created="Mon, 17 Dec 2007 20:47:27 +0000"  >&lt;p&gt;Another suggestion: Check info files and rewrite them if broken (Seems to be at root of &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-236&quot; title=&quot;NPE on failed open of region&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-236&quot;&gt;&lt;del&gt;HADOOP-2445&lt;/del&gt;&lt;/a&gt;)&lt;/p&gt;</comment>
                            <comment id="12552595" author="jimk" created="Tue, 18 Dec 2007 00:58:18 +0000"  >&lt;p&gt;Would it make sense to write the HRegionInfo into a file in the HRegion directory?&lt;/p&gt;

&lt;p&gt;If we were just scanning the disk, it would make it easier to figure out what region was in the HRegion directory.&lt;/p&gt;

&lt;p&gt;Maybe not, because then we&apos;d have to deal with splits.&lt;/p&gt;

&lt;p&gt;How about writing the region name to a file in the region directory?&lt;/p&gt;

&lt;p&gt;Also probably not since it is hard to decode a region name.&lt;/p&gt;

&lt;p&gt;The goal here is be able to recover the meta table if it is corrupted. Similarly recovering the root region from the meta region(s) if the root region is corrupted.&lt;/p&gt;</comment>
                            <comment id="12553195" author="jimk" created="Wed, 19 Dec 2007 01:46:56 +0000"  >&lt;p&gt;In the Region directory, write an info file which contains the region name.&lt;/p&gt;

&lt;p&gt;We now have the row key for the meta, and can compute the encoded region name.&lt;/p&gt;

&lt;p&gt;Currently, only the HStores know if they are a reference to another HStore. They need to know this so they can construct the right kind of reader.&lt;/p&gt;

&lt;p&gt;However, the region itself doesn&apos;t know that is is a child region and whether or not it has a reference to a parent region. This would also be useful information to know when just recovering from the files in hdfs&lt;/p&gt;</comment>
                            <comment id="12553203" author="jimk" created="Wed, 19 Dec 2007 02:17:28 +0000"  >&lt;p&gt;Addresses &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-311&quot; title=&quot;[hbase] HStoreFile.writeSplitInfo should just call HStoreFile.Reference.write&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-311&quot;&gt;&lt;del&gt;HADOOP-2458&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-216&quot; title=&quot;[hbase] When split parent regions are cleaned up, not all the columns are deleted&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-216&quot;&gt;&lt;del&gt;HADOOP-2465&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12553246" author="jimk" created="Wed, 19 Dec 2007 06:33:58 +0000"  >&lt;p&gt;Passes locally, try Hudson&lt;/p&gt;</comment>
                            <comment id="12553255" author="hadoopqa" created="Wed, 19 Dec 2007 07:48:23 +0000"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
&lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12371914/patch.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12371914/patch.txt&lt;/a&gt;&lt;br/&gt;
against trunk revision r605441.&lt;/p&gt;

&lt;p&gt;    @author +1.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    javadoc +1.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    javac +1.  The applied patch does not generate any new compiler warnings.&lt;/p&gt;

&lt;p&gt;    findbugs +1.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    core tests +1.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    contrib tests +1.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1391/testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1391/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1391/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1391/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle results: &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1391/artifact/trunk/build/test/checkstyle-errors.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1391/artifact/trunk/build/test/checkstyle-errors.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1391/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1391/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12556287" author="stack" created="Sat, 5 Jan 2008 21:36:46 +0000"  >&lt;p&gt;hbasck should take an option that renders the table being checked read-only while it runs.&lt;/p&gt;

&lt;p&gt;hbasck is probably also one place where we&apos;d locate the force-flush and then force-compaction of all stores feature.&lt;/p&gt;

&lt;p&gt;See &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-43&quot; title=&quot;[hbase] Add a read-only attribute to columns&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-43&quot;&gt;&lt;del&gt;HADOOP-1958&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="12558356" author="viper799" created="Sun, 13 Jan 2008 07:31:47 +0000"  >&lt;p&gt;Can we commit this and open a new jira for the add on options you would like added to this stack?&lt;/p&gt;</comment>
                            <comment id="12558436" author="jimk" created="Sun, 13 Jan 2008 18:23:30 +0000"  >&lt;p&gt;Patch was for one of the sub-issues and has been committed.&lt;/p&gt;

&lt;p&gt;The main issue has not yet been addressed.&lt;/p&gt;</comment>
                            <comment id="12558447" author="bryanduxbury" created="Sun, 13 Jan 2008 20:57:19 +0000"  >&lt;p&gt;Should we adjust the fix version out to 0.17 if the main issue hasn&apos;t been addressed yet?&lt;/p&gt;</comment>
                            <comment id="12558450" author="jimk" created="Sun, 13 Jan 2008 21:45:38 +0000"  >&lt;p&gt;Pushing fix out to 0.17 since adding the referential integrity needed to make this tool really work will require another migration tool.&lt;/p&gt;</comment>
                            <comment id="12558510" author="stack" created="Mon, 14 Jan 2008 05:54:14 +0000"  >&lt;p&gt;Are you going to rename the current migration script &apos;migrate&apos; for 0.16 (so users always know that to migrate, they need to run the &apos;migrate&apos; tool &amp;#8211; not &apos;updateRegionDirs&apos; followed by &apos;addIntegrityChecks&apos; followd by &apos;polishTheWindows&apos;...)?  (The migrate script will know by looking at the FS what subscripts to run, etc.).&lt;/p&gt;</comment>
                            <comment id="12570337" author="stack" created="Tue, 19 Feb 2008 17:47:52 +0000"  >&lt;p&gt;Its possible that a delete of a table could be interrupted with regions and the table dir left imcompletely removed.  hbasck should take a look-see and clean up any leftovers.&lt;/p&gt;</comment>
                            <comment id="12689946" author="gunonur" created="Fri, 27 Mar 2009 16:07:00 +0000"  >&lt;p&gt;Is is possible that we have a case where forcing flush after the checks is more appropriate than forcing before? When it should be done?&lt;/p&gt;

&lt;p&gt;Let&apos;s say we have a region1 having faulty data. We have run hbasck. It forced flush and we now have region11 and region12. If region1 did not have faulty data, we would have only region1. Later the compaction resolved this, but split and compaction ran for nothing in this region server.&lt;/p&gt;

&lt;p&gt;If i am wrong, please point me what to look for.&lt;/p&gt;</comment>
                            <comment id="12690114" author="jimk" created="Fri, 27 Mar 2009 21:31:39 +0000"  >&lt;p&gt;There are (at least) three areas where we are still vulnerable:&lt;/p&gt;

&lt;p&gt;1. Incomplete table deletion. (see above)&lt;br/&gt;
2. Incomplete cache flush (region server dies during flush) see below.&lt;br/&gt;
3. Inability to recover write ahead log (HLog) if server dies. Depends on &lt;a href=&quot;https://issues.apache.org/jira/browse/HDFS-200&quot; title=&quot;In HDFS, sync() not yet guarantees data available to the new readers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HDFS-200&quot;&gt;&lt;del&gt;HADOOP-4379&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;HBase protects itself from incomplete compactions by performing the operation in a temporary directory. If the compaction does not complete successfully, another compaction request will be generated and the partially completed compaction data is erased.&lt;/p&gt;

&lt;p&gt;We should do  something similar for a cache flush: write the flush to a temporary directory and move the new store file into place only if the flush completes successfully. Any subsequent cache flush will erase data in the temporary flush directory. Recovery will happen when HLog is replayed by new server for the region.&lt;/p&gt;

&lt;p&gt;Without &lt;a href=&quot;https://issues.apache.org/jira/browse/HDFS-200&quot; title=&quot;In HDFS, sync() not yet guarantees data available to the new readers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HDFS-200&quot;&gt;&lt;del&gt;HADOOP-4379&lt;/del&gt;&lt;/a&gt;, we cannot guarantee that we can recover the most recent HLog file. Although Dhruba is looking at the issue, he would probably accept help from someone else. Getting &lt;a href=&quot;https://issues.apache.org/jira/browse/HDFS-200&quot; title=&quot;In HDFS, sync() not yet guarantees data available to the new readers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HDFS-200&quot;&gt;&lt;del&gt;HADOOP-4379&lt;/del&gt;&lt;/a&gt; integrated into Hadoop is the most important thing we can do to ensure data integrity.&lt;/p&gt;

&lt;p&gt;The second most important thing to do is to put cache flushes into a temporary directory.&lt;/p&gt;

&lt;p&gt;That would leave hbasefsck handling incomplete deletes (and perhaps other inconsistencies in the HBase file structure)&lt;/p&gt;</comment>
                            <comment id="12690117" author="jimk" created="Fri, 27 Mar 2009 21:35:47 +0000"  >&lt;p&gt;If we cannot get &lt;a href=&quot;https://issues.apache.org/jira/browse/HDFS-200&quot; title=&quot;In HDFS, sync() not yet guarantees data available to the new readers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HDFS-200&quot;&gt;&lt;del&gt;HADOOP-4379&lt;/del&gt;&lt;/a&gt; soon we should investigate using BookKeeper for HLogs. (see &lt;a href=&quot;https://issues.apache.org/jira/browse/HDFS-234&quot; title=&quot;Integration with BookKeeper logging system&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HDFS-234&quot;&gt;&lt;del&gt;HADOOP-5189&lt;/del&gt;&lt;/a&gt;)&lt;/p&gt;</comment>
                            <comment id="12693717" author="stack" created="Mon, 30 Mar 2009 10:34:18 +0000"  >&lt;p&gt;Onur, can you say more about what you are asking?&lt;/p&gt;

&lt;p&gt;Of note, flushes and compactions can now be done from the shell &amp;#8211; see under tools (Tools in shell might be the place to expose hbfsck facility).&lt;/p&gt;

&lt;p&gt;Other notes: Ryan just noted that rather than put table into read-only mode, might want a facility to put it into safe-mode.&lt;/p&gt;</comment>
                            <comment id="12693739" author="gunonur" created="Mon, 30 Mar 2009 11:54:09 +0000"  >&lt;p&gt;Sorry for late reply.&lt;/p&gt;

&lt;p&gt;Hi Jim and stack,&lt;/p&gt;

&lt;p&gt;Thanks for the replies. Maybe i am thinking of an exceptional or irrelevant situation, i don&apos;t know for sure. But let me try to explain.&lt;/p&gt;

&lt;p&gt;Lets say that we have run hbasck. It forces flush as it is suggested. Since the base functionality of hbasck is to work in a corruption state; lets say we have corrupt mapfiles, storefiles or regions. I just wonder if there could be a case, that flush triggers some other events or event series &quot;just&quot; because of the corruptions. I mean we reach the split size etc just because of the flush and corruptions.This will not probably effect the results, but i wonder if forcing the flush is the best case. Maybe we should do correction and we should flush later or anything else.  I don&apos;t know if this is possible or i am on the correct track, i just need a direction to think of.&lt;/p&gt;

&lt;p&gt;I am planning to do this as my SOC by the way. If anybody suggests any other ideas, i will prepare them for my proposal and research to learn more. I will also email Dhruba and try to help if he needs. I think that, i can help testing &lt;a href=&quot;https://issues.apache.org/jira/browse/HDFS-200&quot; title=&quot;In HDFS, sync() not yet guarantees data available to the new readers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HDFS-200&quot;&gt;&lt;del&gt;HADOOP-4379&lt;/del&gt;&lt;/a&gt; for now. &lt;/p&gt;</comment>
                            <comment id="12693804" author="jimk" created="Mon, 30 Mar 2009 15:26:40 +0000"  >&lt;p&gt;hbasefsck was intended to be a tool used while hdfs was running but hbase was offline. So I do not understand how flush enters the picture.&lt;/p&gt;

&lt;p&gt;The idea was for it to walk through the entire on-disk structure of an hbase installation, and repair &apos;stuff that is broken&apos; such as bad entries in the meta and root region, &apos;extra files&apos;, etc.&lt;/p&gt;

&lt;p&gt;If you have a different idea, please post it. We are always open to new approaches.&lt;/p&gt;</comment>
                            <comment id="12693807" author="gunonur" created="Mon, 30 Mar 2009 15:38:12 +0000"  >&lt;p&gt;I understood the steps now. I have thought that hbase was also online and that made things complicated. Thank you.&lt;/p&gt;</comment>
                            <comment id="12694344" author="ryanobjc" created="Wed, 1 Apr 2009 01:18:55 +0000"  >&lt;p&gt;I had a sick cluster after severe OOME, the symptom seemed to be that there were more regions than there really were. &lt;/p&gt;

&lt;p&gt;I used this tool to help recover my cluster and get going again.&lt;/p&gt;</comment>
                            <comment id="12694382" author="gunonur" created="Wed, 1 Apr 2009 05:06:34 +0000"  >&lt;p&gt;I am trying to finalize my proposal and i welcome any comments for the below.&lt;/p&gt;

&lt;p&gt;I have examined Ryan&apos;s patch and for deleting bogus entries in .META. In the patch there is a comment that &quot;it is a trivial fix case&quot;. At this point i wonder if we can have any other cases for bogus entries that hbasfck should resolve in a different manner.&lt;/p&gt;

&lt;p&gt;And since we are vulnerable in deletion, flush and HLog, I guess hbascfck should assume that some of these are resolved. If we are fixing meta from files, we assume that files are correct.&lt;/p&gt;

&lt;p&gt;As of now i guess what needs to be done is:&lt;br/&gt;
1-)We should force flush and compaction (for now we can have problems related to incomplete cache flush and HLog). After that we should put table into safe-mode(since otherwise hbasfck can not operate safely, and i guess this will be similar to dfsadmin safemode).&lt;br/&gt;
2-)Recovering root region from meta regions.&lt;br/&gt;
3-)Listing all regions, comparing them with the .META. As a result recovering meta from regions &lt;br/&gt;
by adding or deleting (Done by Ryan&apos;s patch i guess) .META entries.&lt;br/&gt;
4-)Checking info files.&lt;/p&gt;

&lt;p&gt;More can be:&lt;br/&gt;
5-) Adding an option for taking a snapshot before the fix.&lt;br/&gt;
6-) Creating a log file that can be used to track improvement needs and problems.&lt;/p&gt;</comment>
                            <comment id="12694385" author="ryanobjc" created="Wed, 1 Apr 2009 05:14:20 +0000"  >&lt;p&gt;There are some other things that can be done:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Rebuilding .META. if is totally ruined.&lt;/li&gt;
	&lt;li&gt;Automate more of the checking that HbaseFsck fails on - if you have multiple region directories for the same start key/end key, the tool tells you so and barfs out and lets you resolve it by hand (moving stuff out of /hbase/table_name).&lt;/li&gt;
	&lt;li&gt;Other byzantine error cases.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;One thing we want to probably avoid is unnecessary read/writes - flush is good, but major compactions is probably not good.  Compactions to resolve parent/child split relationships good too.&lt;/p&gt;

&lt;p&gt;I have an outstanding patch that provides a tool called HFileStats which dumps the meta blocks of a HFile (the 0.20 storage format)... the stats contain start/end key, and will allow us to figure if a hfile for a region matches or what region it might actually belong to (for rebuilding .META. info).&lt;/p&gt;

&lt;p&gt;Lots of work to be done, and I hope my initial stab at it (spurred by a broken cluster I thereby fixed) will make a good framework for further work.&lt;/p&gt;

&lt;p&gt;Good luck!&lt;/p&gt;</comment>
                            <comment id="12694388" author="gunonur" created="Wed, 1 Apr 2009 05:22:07 +0000"  >&lt;p&gt;Hi Ryan, I have learned a lot from your patch, will work on it in more detail. Thanks for your recommendations.&lt;/p&gt;</comment>
                            <comment id="12694522" author="jdcryans" created="Wed, 1 Apr 2009 13:27:50 +0000"  >&lt;p&gt;Onur,&lt;/p&gt;

&lt;p&gt;Working on something that rebuilds META would be very appreciated. For example, last week we had a power failure while META was being compacted and its only store file was lost! Fortunately most of our data is recoverable (segments) and the important stuff was in a backup.&lt;/p&gt;</comment>
                            <comment id="12694563" author="stack" created="Wed, 1 Apr 2009 14:55:34 +0000"  >&lt;p&gt;Other things:&lt;/p&gt;

&lt;p&gt;+ Clean up dross in the filesystem.  An option on hbfsck would go through the filesystem and remove anything not referenced.  For example, the powerset instance of hbase has been migrated multiple times and there is a bunch of junk under /hbase.  I could go through manually deleting stuff but I&apos;m afraid I&apos;d remove something needed.  Tool could also look at regions and make sure they have a reference in .META.   If not, then they have been left over somehow and can be cleaned (&quot;OK to remove region XYZ?&quot;).&lt;br/&gt;
+ Region names on filesystem are encoded.   An info file that said what actual name was and other attributes of region would help hbfsck put things back together again &amp;#8211; would also help debugging a hosed cluster.&lt;br/&gt;
+ (Stretch goal) If a data file is corrupt, rewrite it with as much of the original data as is possible to save (skip bad section).  Make smart decisions about edit sequence id, etc., if unreadable inferring from neighbors if necessary.&lt;br/&gt;
+ (Stretch goal) Have an --info mode where hbfsck dumps out stats on the content of the filesystem &lt;/p&gt;

&lt;p&gt;First cut, I&apos;d imagine, the hbfsck would run through the filesystem looking at content of zk and .META. and try to report anomalies.  Next step after that would be effect repair.  Part of the hbfsck dev. would be figuring what you need in filesystem to do things like repair a broken .META. or to figure what content is dangling/unreferenced.&lt;/p&gt;

&lt;p&gt;See how your tool is evolving.  As you write it, keep in mind that you might later want to host it inside a MR job &amp;#8211; especially if you ever need to read a fat hbase instance with lots of regions.  Also consider, as in fsck, that you might have a &apos;quick&apos; mode (Just a thought).&lt;/p&gt;

&lt;p&gt;It should probably run like fsck where it asks yes/no when its effecting repair (user should be able to pass flag which says &apos;yes&apos; to all questions).&lt;/p&gt;

&lt;p&gt;Documentation and clean integration with shell I&apos;d imagine, would be key components of any hbasck tool since it&apos;ll only be needed rarely but when it is, the user in distress will want to be clear on how it all works.&lt;/p&gt;

&lt;p&gt;Hope this helps.&lt;/p&gt;</comment>
                            <comment id="12694717" author="gunonur" created="Wed, 1 Apr 2009 20:23:11 +0000"  >&lt;p&gt;I have submitted my proposal by considering all recommendations up to now. I will be watching the issue for possible comments. Thank you.&lt;/p&gt;</comment>
                            <comment id="12695859" author="gunonur" created="Sun, 5 Apr 2009 14:07:33 +0000"  >&lt;p&gt;When we have succesfully dropped a table, HBase does not remove the directory /hbase/mytablename in HDFS. Hbfsck should also remove these.&lt;/p&gt;</comment>
                            <comment id="12702594" author="stack" created="Fri, 24 Apr 2009 22:46:37 +0000"  >&lt;p&gt;Moving out of 0.20.0.  If tool shows up meantime, well and good; we&apos;ll commit it.  Trying to prune the number of issues we have filed against 0.20.0.&lt;/p&gt;</comment>
                            <comment id="12754091" author="larsgeorge" created="Fri, 11 Sep 2009 11:34:22 +0000"  >&lt;p&gt;From &lt;a href=&quot;http://devblog.streamy.com/2009/08/09/hbase-hackathon-2-day-one/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://devblog.streamy.com/2009/08/09/hbase-hackathon-2-day-one/&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Sequence IDs&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Change to stamps?&lt;/li&gt;
	&lt;li&gt;Must be unique&lt;/li&gt;
	&lt;li&gt;Fix for merges&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
	&lt;li&gt;Start/end keys match&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Figures out / runs merges&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
	&lt;li&gt;Repair references&lt;/li&gt;
	&lt;li&gt;Two modes&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Quick mode scans META&lt;/li&gt;
	&lt;li&gt;Full mode reads HFiles and verifies fully&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12848006" author="tlipcon" created="Sun, 21 Mar 2010 23:36:04 +0000"  >&lt;p&gt;Anyone working on this these days? I&apos;d love to see this in 0.21 - when a table gets out of sync with meta it really would be great to have a tool.&lt;/p&gt;</comment>
                            <comment id="12848253" author="stack" created="Mon, 22 Mar 2010 18:06:18 +0000"  >&lt;p&gt;Flagging as a gsoc possible project.&lt;/p&gt;</comment>
                            <comment id="12868867" author="stack" created="Tue, 18 May 2010 22:11:40 +0000"  >&lt;p&gt;Silly little script that takes tablename, startkey, and endkey and inserts into meta an entry.  Does not check fs.  Presumes that you are not trying to fixup the first region in table (it reads first region in table to learn the table descriptor).  This is a hack to quickly help out someone w/ hole in their table.&lt;/p&gt;</comment>
                            <comment id="12870900" author="stack" created="Mon, 24 May 2010 23:04:19 +0000"  >&lt;p&gt;Script that will run through .META. looking for holes where the former regions endkey does not match the startkey.   If you pass --fix, it will search the fs looking for candidate region and will load it into meta if it finds one.&lt;/p&gt;</comment>
                            <comment id="12870903" author="stack" created="Mon, 24 May 2010 23:18:44 +0000"  >&lt;p&gt;I added the check_meta.rb script to TRUNK&lt;/p&gt;</comment>
                            <comment id="12871356" author="stack" created="Tue, 25 May 2010 20:52:13 +0000"  >&lt;p&gt;This version deals with offlined parents.&lt;/p&gt;</comment>
                            <comment id="12871563" author="stack" created="Wed, 26 May 2010 08:35:16 +0000"  >&lt;p&gt;TODO: Add verifying that the regionserver in server field is actually carrying the region listed in .META.&lt;/p&gt;</comment>
                            <comment id="12871794" author="streamy" created="Wed, 26 May 2010 16:32:35 +0000"  >&lt;p&gt;FYI, there is an existing call in HRegionInterface that can be used:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;public HRegionInfo[] getRegionsAssignment() throws IOException;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Currently that&apos;s being used during master failover though this may change with the zk/master stuff underway, I think it will still make sense to retain this call for debugging/fsck.&lt;/p&gt;

&lt;p&gt;While on the subject, there&apos;s also another call in HRI:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;public HRegion [] getOnlineRegionsAsArray();&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This doesn&apos;t appear to be used anywhere except in 4 commented-out tests in TestHBaseAdmin &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;  Unless there are objections, I&apos;m going to remove it while doing other cleanup in master/client/rs comm.&lt;/p&gt;</comment>
                            <comment id="12871849" author="dhruba" created="Wed, 26 May 2010 17:52:27 +0000"  >&lt;p&gt;I am in the process of writing a java utility that uses getOnlineRegionsAsArray (among many other calls to Master and regionserver) that will display a report of any inconsistencies between master/regionserver/hdfs.. I will post this patch (along with documentation) very soon.&lt;/p&gt;</comment>
                            <comment id="12871851" author="dhruba" created="Wed, 26 May 2010 17:54:20 +0000"  >&lt;p&gt;I meant I am using getRegionsAssignment() (I am not using getOnlineRegionsAsArray)&lt;/p&gt;</comment>
                            <comment id="12881374" author="stack" created="Tue, 22 Jun 2010 21:43:35 +0000"  >&lt;p&gt;Committed.  Add the bit to hook it up so it shows when you do bin/hbase (as per Nicolas suggestion).  Lets file new issues to improve of if bugs.&lt;/p&gt;</comment>
                            <comment id="12882036" author="stack" created="Thu, 24 Jun 2010 04:50:59 +0000"  >&lt;p&gt;I  made some comments over on review.hbase.org but they didn&apos;t make it in here.  Go there if interested.  Let me also attach Dhruba&apos;s patch here in case anyone goes looking for it.&lt;/p&gt;</comment>
                            <comment id="12882038" author="stack" created="Thu, 24 Jun 2010 04:52:53 +0000"  >&lt;p&gt;Here is Dhruba&apos;s patch copied over from review.hbase.org.  Its what I committed (my commit also made this script show through when you do bin/hbase... its the hbck option).&lt;/p&gt;</comment>
                            <comment id="12885589" author="ted_yu" created="Tue, 6 Jul 2010 16:39:47 +0000"  >&lt;p&gt;HBaseConfiguration.java and HBaseFsck.java, patched for 0.20.5 release.&lt;/p&gt;</comment>
                            <comment id="12888010" author="stack" created="Tue, 13 Jul 2010 21:11:05 +0000"  >&lt;p&gt;@Ted&lt;/p&gt;

&lt;p&gt;You don&apos;t need to make the HBaseConfiguration change.  In fact you shouldn&apos;t.  Better to change the HBaseConfiguration.create to new HBaseConfiguration in HBaseFsck.&lt;/p&gt;

&lt;p&gt;I tried it and it gives me the following issue:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-object&quot;&gt;Number&lt;/span&gt; of Tables: 1
&lt;span class=&quot;code-object&quot;&gt;Number&lt;/span&gt; of live region servers:1
&lt;span class=&quot;code-object&quot;&gt;Number&lt;/span&gt; of dead region servers:0
Exception in thread &lt;span class=&quot;code-quote&quot;&gt;&quot;main&quot;&lt;/span&gt; java.lang.NullPointerException
        at org.apache.hadoop.hbase.client.HBaseFsck.processRegionServers(HBaseFsck.java:309)
        at org.apache.hadoop.hbase.client.HBaseFsck.doWork(HBaseFsck.java:162)
        at org.apache.hadoop.hbase.client.HBaseFsck.main(HBaseFsck.java:534)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Do you see that?&lt;/p&gt;</comment>
                            <comment id="12899087" author="lukeforehand" created="Mon, 16 Aug 2010 20:59:01 +0000"  >&lt;p&gt;I just ran this utility on our corrupt META table and got this exception:&lt;/p&gt;

&lt;p&gt;Exception in thread &quot;main&quot; java.io.IOException: Two entries in META are same REGION =&amp;gt; {NAME =&amp;gt; &apos;feedData,20100717 0463ff1d352930dc354f35358d3d11997c2fa050,1281549071340.d905798b9e7dca1c24a09a908bd1081c.&apos;, STARTKEY =&amp;gt; &apos;20100717 0463ff1d352930dc354f35358d3d11997c2fa050&apos;, ENDKEY =&amp;gt; &apos;20100717 25beb50790d72e3e2bf1fbebc0656dbcd82cdbd3&apos;, ENCODED =&amp;gt; d905798b9e7dca1c24a09a908bd1081c, TABLE =&amp;gt; {{NAME =&amp;gt; &apos;feedData&apos;, FAMILIES =&amp;gt; [&lt;/p&gt;
{NAME =&amp;gt; &apos;core&apos;, BLOOMFILTER =&amp;gt; &apos;NONE&apos;, REPLICATION_SCOPE =&amp;gt; &apos;0&apos;, COMPRESSION =&amp;gt; &apos;LZO&apos;, VERSIONS =&amp;gt; &apos;3&apos;, TTL =&amp;gt; &apos;2147483647&apos;, BLOCKSIZE =&amp;gt; &apos;131072&apos;, IN_MEMORY =&amp;gt; &apos;false&apos;, BLOCKCACHE =&amp;gt; &apos;true&apos;}
&lt;p&gt;, &lt;/p&gt;
{NAME =&amp;gt; &apos;tf&apos;, BLOOMFILTER =&amp;gt; &apos;NONE&apos;, REPLICATION_SCOPE =&amp;gt; &apos;0&apos;, COMPRESSION =&amp;gt; &apos;LZO&apos;, VERSIONS =&amp;gt; &apos;3&apos;, TTL =&amp;gt; &apos;2147483647&apos;, BLOCKSIZE =&amp;gt; &apos;131072&apos;, IN_MEMORY =&amp;gt; &apos;false&apos;, BLOCKCACHE =&amp;gt; &apos;true&apos;}
&lt;p&gt;, &lt;/p&gt;
{NAME =&amp;gt; &apos;tfidf&apos;, BLOOMFILTER =&amp;gt; &apos;NONE&apos;, REPLICATION_SCOPE =&amp;gt; &apos;0&apos;, COMPRESSION =&amp;gt; &apos;LZO&apos;, VERSIONS =&amp;gt; &apos;3&apos;, TTL =&amp;gt; &apos;2147483647&apos;, BLOCKSIZE =&amp;gt; &apos;131072&apos;, IN_MEMORY =&amp;gt; &apos;false&apos;, BLOCKCACHE =&amp;gt; &apos;true&apos;}
&lt;p&gt;]}}&lt;br/&gt;
	at org.apache.hadoop.hbase.client.HBaseFsck$1.processRow(HBaseFsck.java:420)&lt;br/&gt;
	at org.apache.hadoop.hbase.client.MetaScanner.metaScan(MetaScanner.java:156)&lt;br/&gt;
	at org.apache.hadoop.hbase.client.MetaScanner.metaScan(MetaScanner.java:68)&lt;br/&gt;
	at org.apache.hadoop.hbase.client.MetaScanner.metaScan(MetaScanner.java:53)&lt;br/&gt;
	at com.ni.ods.hadoop.utils.HBaseFsck.getMetaEntries(HBaseFsck.java:435)&lt;br/&gt;
	at com.ni.ods.hadoop.utils.HBaseFsck.doWork(HBaseFsck.java:109)&lt;br/&gt;
	at com.ni.ods.hadoop.utils.HBaseFsck.main(HBaseFsck.java:522)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
	at java.lang.reflect.Method.invoke(Method.java:597)&lt;br/&gt;
	at org.apache.hadoop.util.RunJar.main(RunJar.java:186)&lt;/p&gt;</comment>
                            <comment id="15017882" author="lars_francke" created="Fri, 20 Nov 2015 13:01:44 +0000"  >&lt;p&gt;This issue was closed as part of a bulk closing operation on 2015-11-20. All issues that have been resolved and where all fixVersions have been released have been closed (following discussions on the mailing list).&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12423637">HBASE-1342</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                            <outwardlinks description="incorporates">
                                        <issuelink>
            <issuekey id="12384927">HBASE-216</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12384805">HBASE-236</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12384900">HBASE-311</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12385050">HBASE-339</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12423637">HBASE-1342</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12464176">HBASE-2526</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12436554">HBASE-1867</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12404294" name="HBASE-7.patch" size="13097" author="ryanobjc" created="Wed, 1 Apr 2009 01:18:55 +0000"/>
                            <attachment id="12448796" name="HBaseConfiguration.java" size="3185" author="ted_yu" created="Tue, 6 Jul 2010 16:39:47 +0000"/>
                            <attachment id="12448795" name="HBaseFsck.java" size="20709" author="ted_yu" created="Tue, 6 Jul 2010 16:39:47 +0000"/>
                            <attachment id="12444839" name="add_region.rb" size="2387" author="stack" created="Tue, 18 May 2010 22:11:40 +0000"/>
                            <attachment id="12445494" name="check_meta.rb" size="5215" author="stack" created="Tue, 25 May 2010 20:52:12 +0000"/>
                            <attachment id="12445398" name="check_meta.rb" size="5033" author="stack" created="Mon, 24 May 2010 23:04:19 +0000"/>
                            <attachment id="12447924" name="hbase.fsck1.txt" size="21374" author="stack" created="Thu, 24 Jun 2010 04:52:52 +0000"/>
                            <attachment id="12371914" name="patch.txt" size="2084" author="jimk" created="Wed, 19 Dec 2007 02:17:28 +0000"/>
                    </attachments>
                <subtasks>
                            <subtask id="12411634">HBASE-1108</subtask>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>8.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 17 Dec 2007 20:44:35 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>31631</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 4 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0h3db:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>97808</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>